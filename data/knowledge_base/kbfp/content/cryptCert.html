<!DOCTYPE HTML>
<html lang="en" class="hacktricks-light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Certificates - HackTricks</title>

        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="../theme/pagetoc.css">
        <link rel="stylesheet" href="../theme/tabs.css">


        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../";
            var lang = "en";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "hacktricks-dark" : "hacktricks-light";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../toc.js"></script>
    </head>
    <body>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('hacktricks-light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            var body = document.querySelector("body");
            if (document.body.clientWidth >= 550) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
            body.classList.remove('sidebar-visible');
            body.classList.add("sidebar-" + sidebar);
        </script>

        <div id="page-wrapper" class="page-wrapper">
            <div id="search-wrapper" class="hidden">
                <div id="search-modal">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <span class="fa fa-search"></span>
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
            </div>

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="menu-bar-container">
                        <div class="left-buttons">
                            <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                                <i class="fa fa-bars"></i>
                            </label>
                            <a href="/">
                                <h1 class="menu-title"><img src="../../../../../images/CLOUD-web-logo.png" alt="" style="width:auto;height:30px;vertical-align:middle;margin-right:5px;">HackTricks</h1>
                            </a>

                        </div>


                        <div class="right-buttons">
                            <div id="menubar-collapse">
                                <a class="menu-bar-link" href="https://training.hacktricks.xyz" target="_blank">
                                    Hacktricks Training
                                </a>
                                <a class="menu-bar-link" href="https://twitter.com/hacktricks_live" target="_blank">
                                    Twitter
                                </a>
                                <a class="menu-bar-link" href="https://www.linkedin.com/company/hacktricks" target="_blank">
                                    Linkedin
                                </a>
                                <a class="menu-bar-link" href="https://github.com/sponsors/carlospolop" target="_blank">
                                    Sponsor
                                </a>
                            </div>
                            <div class="icons">
                                <div id="menubar-collapse-toggle" class="icon-button" type="button" title="Toggle menu bar" aria-label="Toggle Menu bar" aria-expanded="false" aria-controls="collapse">
                                    <i class="fa fa-ellipsis-h"></i>
                                    <div id="menubar-collapse-popup" class="menubar-collapse-popup" aria-label="Menu" role="menu">
                                        <a href="https://training.hacktricks.xyz" target="_blank" role="menuitem" class="menu-bar-link">Hacktricks Training</a>
                                        <a href="https://twitter.com/hacktricks_live" target="_blank" role="menuitem" class="menu-bar-link">Twitter</a>
                                        <a href="https://www.linkedin.com/company/hacktricks" target="_blank" role="menuitem" class="menu-bar-link">Linkedin</a>
                                        <a href="https://github.com/sponsors/carlospolop" target="_blank" role="menuitem" class="menu-bar-link">Sponsor</a>
                                    </div>
                                </div>

                                <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                                    <i class="fa fa-search"></i>
                                </button>

                                <div id="menubar-languages-toggle" class="icon-button" type="button" title="Translations" aria-label="Toggle Tanslations" aria-expanded="false" aria-controls="translations">
                                    <i class="fa fa-globe"></i>
                                    <span class="menu-bar-link">Translations</span>
                                    
                                    <div id="menubar-languages-popup" class="menubar-languages-popup" aria-label="Language menu" role="language menu">
                                        <button id="af" role="menuitem" class="menu-bar-link">Afrikaans</button>
                                        <button id="zh" role="menuitem" class="menu-bar-link">Chinese</button>
                                        <button id="en" role="menuitem" class="menu-bar-link">English</button>
                                        <button id="fr" role="menuitem" class="menu-bar-link">French</button>
                                        <button id="de" role="menuitem" class="menu-bar-link">German</button>
                                        <button id="el" role="menuitem" class="menu-bar-link">Greek</button>
                                        <button id="hi" role="menuitem" class="menu-bar-link">Hindi</button>
                                        <button id="it" role="menuitem" class="menu-bar-link">Italian</button>
                                        <button id="ja" role="menuitem" class="menu-bar-link">Japanese</button>
                                        <button id="ko" role="menuitem" class="menu-bar-link">Korean</button>
                                        <button id="pl" role="menuitem" class="menu-bar-link">Polish</button>
                                        <button id="pt" role="menuitem" class="menu-bar-link">Portuguese</button>
                                        <button id="sr" role="menuitem" class="menu-bar-link">Serbian</button>
                                        <button id="es" role="menuitem" class="menu-bar-link">Spanish</button>
                                        <button id="sw" role="menuitem" class="menu-bar-link">Swahili</button>
                                        <button id="tr" role="menuitem" class="menu-bar-link">Turkish</button>
                                        <button id="uk" role="menuitem" class="menu-bar-link">Ukrainian</button>
                                    </div>
                                </div>
                            </div>


                        </div>
                    </div>
                </div>
                <div id="container" class="container">
                    <nav id="sidebar" class="sidebar" aria-label="Table of contents">
                        <!-- populated by js -->
                        <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
                        <noscript>
                            <iframe class="sidebar-iframe-outer" src="../toc.html"></iframe>
                        </noscript>
                    </nav>
                    <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                    <script>
                        document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                        document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                        Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                            link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                        });
                    </script>

                    <div id="content" class="content">
                        <main>
                            <div class="mobilesponsor-wrapper">

                            <a class="mobilesponsor" href="" target="_blank">
                                <img src="" alt="" srcset="">
                                <div class="mobilesponsor-title">
                                </div>
                                <div class="mobilesponsor-description">
                                </div>
                                <div class="mobilesponsor-cta"></div>
                            </a>
                            </div>
                            <style>
.mdbook-alerts {
  padding: 8px 16px;
  margin-bottom: 16px;
  border-left: 0.25em solid var(--mdbook-alerts-color);
}

.mdbook-alerts > *:first-child {
  margin-top: 0;
}

.mdbook-alerts > *:last-child {
  margin-bottom: 0;
}

.mdbook-alerts-title {
  display: flex;
  font-weight: 600;
  align-items: center;
  line-height: 1;
  color: var(--mdbook-alerts-color);
  text-transform: capitalize;
}

.mdbook-alerts-icon {
  display: inline-block;
  width: 1em;
  height: 1em;
  margin-right: 0.2em;
  background-color: currentColor;
  -webkit-mask: no-repeat center / 100%;
  mask: no-repeat center / 100%;
  -webkit-mask-image: var(--mdbook-alerts-icon);
  mask-image: var(--mdbook-alerts-icon);
}

.mdbook-alerts-note {
  --mdbook-alerts-color: rgb(9, 105, 218);
  /* https://icon-sets.iconify.design/material-symbols/info-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 17q.425 0 .713-.288T13 16v-4q0-.425-.288-.712T12 11q-.425 0-.712.288T11 12v4q0 .425.288.713T12 17m0-8q.425 0 .713-.288T13 8q0-.425-.288-.712T12 7q-.425 0-.712.288T11 8q0 .425.288.713T12 9m0 13q-2.075 0-3.9-.788t-3.175-2.137q-1.35-1.35-2.137-3.175T2 12q0-2.075.788-3.9t2.137-3.175q1.35-1.35 3.175-2.137T12 2q2.075 0 3.9.788t3.175 2.137q1.35 1.35 2.138 3.175T22 12q0 2.075-.788 3.9t-2.137 3.175q-1.35 1.35-3.175 2.138T12 22m0-2q3.35 0 5.675-2.325T20 12q0-3.35-2.325-5.675T12 4Q8.65 4 6.325 6.325T4 12q0 3.35 2.325 5.675T12 20m0-8"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-tip {
  --mdbook-alerts-color: rgb(26, 127, 55);
  /* https://icon-sets.iconify.design/material-symbols/lightbulb-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 22q-.825 0-1.412-.587T10 20h4q0 .825-.587 1.413T12 22m-3-3q-.425 0-.712-.288T8 18q0-.425.288-.712T9 17h6q.425 0 .713.288T16 18q0 .425-.288.713T15 19zm-.75-3q-1.725-1.025-2.738-2.75T4.5 9.5q0-3.125 2.188-5.312T12 2q3.125 0 5.313 2.188T19.5 9.5q0 2.025-1.012 3.75T15.75 16zm.6-2h6.3q1.125-.8 1.738-1.975T17.5 9.5q0-2.3-1.6-3.9T12 4Q9.7 4 8.1 5.6T6.5 9.5q0 1.35.613 2.525T8.85 14M12 14"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-important {
  --mdbook-alerts-color: rgb(130, 80, 223);
  /* https://icon-sets.iconify.design/material-symbols/chat-info-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 7q.425 0 .713-.288T13 6q0-.425-.288-.712T12 5q-.425 0-.712.288T11 6q0 .425.288.713T12 7m0 8q.425 0 .713-.288T13 14v-4q0-.425-.288-.712T12 9q-.425 0-.712.288T11 10v4q0 .425.288.713T12 15m-6 3l-2.3 2.3q-.475.475-1.088.213T2 19.575V4q0-.825.588-1.412T4 2h16q.825 0 1.413.588T22 4v12q0 .825-.587 1.413T20 18zm-.85-2H20V4H4v13.125zM4 16V4z"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-warning {
  --mdbook-alerts-color: rgb(154, 103, 0);
  /* https://icon-sets.iconify.design/material-symbols/warning-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M2.725 21q-.275 0-.5-.137t-.35-.363q-.125-.225-.137-.488t.137-.512l9.25-16q.15-.25.388-.375T12 3q.25 0 .488.125t.387.375l9.25 16q.15.25.138.513t-.138.487q-.125.225-.35.363t-.5.137zm1.725-2h15.1L12 6zM12 18q.425 0 .713-.288T13 17q0-.425-.288-.712T12 16q-.425 0-.712.288T11 17q0 .425.288.713T12 18m0-3q.425 0 .713-.288T13 14v-3q0-.425-.288-.712T12 10q-.425 0-.712.288T11 11v3q0 .425.288.713T12 15m0-2.5"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-caution {
  --mdbook-alerts-color: rgb(207, 34, 46);
  /* https://icon-sets.iconify.design/material-symbols/brightness-alert-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 17q.425 0 .713-.288T13 16q0-.425-.288-.712T12 15q-.425 0-.712.288T11 16q0 .425.288.713T12 17m0-4q.425 0 .713-.288T13 12V8q0-.425-.288-.712T12 7q-.425 0-.712.288T11 8v4q0 .425.288.713T12 13m-3.35 7H6q-.825 0-1.412-.587T4 18v-2.65L2.075 13.4q-.275-.3-.425-.662T1.5 12q0-.375.15-.737t.425-.663L4 8.65V6q0-.825.588-1.412T6 4h2.65l1.95-1.925q.3-.275.663-.425T12 1.5q.375 0 .738.15t.662.425L15.35 4H18q.825 0 1.413.588T20 6v2.65l1.925 1.95q.275.3.425.663t.15.737q0 .375-.15.738t-.425.662L20 15.35V18q0 .825-.587 1.413T18 20h-2.65l-1.95 1.925q-.3.275-.662.425T12 22.5q-.375 0-.737-.15t-.663-.425zm.85-2l2.5 2.5l2.5-2.5H18v-3.5l2.5-2.5L18 9.5V6h-3.5L12 3.5L9.5 6H6v3.5L3.5 12L6 14.5V18zm2.5-6"%2F%3E%3C%2Fsvg%3E');
}

</style>
<style>
div.codeblock_filename_container + pre {
  margin-top: 0;
}

span.codeblock_filename_inner {
  border-radius: 0.4rem 0.4rem 0 0;
  padding: 0.6rem 1rem 0.6rem 1rem;
  font-family: var(--mono-font) !important;
  font-size: var(--code-font-size);
}

</style>
<h1 id="certificates"><a class="header" href="#certificates">Certificates</a></h1>
<p>Reading time: 7 minutes</p>
<div class="mdbook-alerts mdbook-alerts-tip">
<p class="mdbook-alerts-title">
  <span class="mdbook-alerts-icon"></span>
  tip
</p>
<p>Learn &amp; practice AWS Hacking:<img src="../../../../../images/arte.png" alt="" style="width:auto;height:24px;vertical-align:middle;"><a href="https://training.hacktricks.xyz/courses/arte"><strong>HackTricks Training AWS Red Team Expert (ARTE)</strong></a><img src="../../../../../images/arte.png" alt="" style="width:auto;height:24px;vertical-align:middle;"><br />
Learn &amp; practice GCP Hacking: <img src="../../../../../images/grte.png" alt="" style="width:auto;height:24px;vertical-align:middle;"><a href="https://training.hacktricks.xyz/courses/grte"><strong>HackTricks Training GCP Red Team Expert (GRTE)</strong></a><img src="../../../../../images/grte.png" alt="" style="width:auto;height:24px;vertical-align:middle;"></p>
<details>
<summary>Support HackTricks</summary>
<ul>
<li>Check the <a href="https://github.com/sponsors/carlospolop"><strong>subscription plans</strong></a>!</li>
<li><strong>Join the</strong> üí¨ <a href="https://discord.gg/hRep4RUj7f"><strong>Discord group</strong></a> or the <a href="https://t.me/peass"><strong>telegram group</strong></a> or <strong>follow</strong> us on <strong>Twitter</strong> üê¶ <a href="https://twitter.com/hacktricks_live"><strong>@hacktricks_live</strong></a><strong>.</strong></li>
<li><strong>Share hacking tricks by submitting PRs to the</strong> <a href="https://github.com/carlospolop/hacktricks"><strong>HackTricks</strong></a> and <a href="https://github.com/carlospolop/hacktricks-cloud"><strong>HackTricks Cloud</strong></a> github repos.</li>
</ul>
</details>
</div>
<h2 id="what-is-a-certificate"><a class="header" href="#what-is-a-certificate">What is a Certificate</a></h2>
<p>A <strong>public key certificate</strong> is a digital ID used in cryptography to prove someone owns a public key. It includes the key's details, the owner's identity (the subject), and a digital signature from a trusted authority (the issuer). If the software trusts the issuer and the signature is valid, secure communication with the key's owner is possible.</p>
<p>Certificates are mostly issued by <a href="https://en.wikipedia.org/wiki/Certificate_authority">certificate authorities</a> (CAs) in a <a href="https://en.wikipedia.org/wiki/Public-key_infrastructure">public-key infrastructure</a> (PKI) setup. Another method is the <a href="https://en.wikipedia.org/wiki/Web_of_trust">web of trust</a>, where users directly verify each other‚Äôs keys. The common format for certificates is <a href="https://en.wikipedia.org/wiki/X.509">X.509</a>, which can be adapted for specific needs as outlined in RFC 5280.</p>
<h2 id="x509-common-fields"><a class="header" href="#x509-common-fields">x509 Common Fields</a></h2>
<h3 id="common-fields-in-x509-certificates"><a class="header" href="#common-fields-in-x509-certificates"><strong>Common Fields in x509 Certificates</strong></a></h3>
<p>In x509 certificates, several <strong>fields</strong> play critical roles in ensuring the certificate's validity and security. Here's a breakdown of these fields:</p>
<ul>
<li><strong>Version Number</strong> signifies the x509 format's version.</li>
<li><strong>Serial Number</strong> uniquely identifies the certificate within a Certificate Authority's (CA) system, mainly for revocation tracking.</li>
<li>The <strong>Subject</strong> field represents the certificate's owner, which could be a machine, an individual, or an organization. It includes detailed identification such as:
<ul>
<li><strong>Common Name (CN)</strong>: Domains covered by the certificate.</li>
<li><strong>Country (C)</strong>, <strong>Locality (L)</strong>, <strong>State or Province (ST, S, or P)</strong>, <strong>Organization (O)</strong>, and <strong>Organizational Unit (OU)</strong> provide geographical and organizational details.</li>
<li><strong>Distinguished Name (DN)</strong> encapsulates the full subject identification.</li>
</ul>
</li>
<li><strong>Issuer</strong> details who verified and signed the certificate, including similar subfields as the Subject for the CA.</li>
<li><strong>Validity Period</strong> is marked by <strong>Not Before</strong> and <strong>Not After</strong> timestamps, ensuring the certificate is not used before or after a certain date.</li>
<li>The <strong>Public Key</strong> section, crucial for the certificate's security, specifies the algorithm, size, and other technical details of the public key.</li>
<li><strong>x509v3 extensions</strong> enhance the certificate's functionality, specifying <strong>Key Usage</strong>, <strong>Extended Key Usage</strong>, <strong>Subject Alternative Name</strong>, and other properties to fine-tune the certificate's application.</li>
</ul>
<h4 id="key-usage-and-extensions"><a class="header" href="#key-usage-and-extensions"><strong>Key Usage and Extensions</strong></a></h4>
<ul>
<li><strong>Key Usage</strong> identifies cryptographic applications of the public key, like digital signature or key encipherment.</li>
<li><strong>Extended Key Usage</strong> further narrows down the certificate's use cases, e.g., for TLS server authentication.</li>
<li><strong>Subject Alternative Name</strong> and <strong>Basic Constraint</strong> define additional host names covered by the certificate and whether it's a CA or end-entity certificate, respectively.</li>
<li>Identifiers like <strong>Subject Key Identifier</strong> and <strong>Authority Key Identifier</strong> ensure uniqueness and traceability of keys.</li>
<li><strong>Authority Information Access</strong> and <strong>CRL Distribution Points</strong> provide paths to verify the issuing CA and check certificate revocation status.</li>
<li><strong>CT Precertificate SCTs</strong> offer transparency logs, crucial for public trust in the certificate.</li>
</ul>
<div class="codeblock_filename_container"><span class="codeblock_filename_inner hljs">python</span></div>
<pre><code class="language-python"># Example of accessing and using x509 certificate fields programmatically:
from cryptography import x509
from cryptography.hazmat.backends import default_backend

# Load an x509 certificate (assuming cert.pem is a certificate file)
with open("cert.pem", "rb") as file:
    cert_data = file.read()
    certificate = x509.load_pem_x509_certificate(cert_data, default_backend())

# Accessing fields
serial_number = certificate.serial_number
issuer = certificate.issuer
subject = certificate.subject
public_key = certificate.public_key()

print(f"Serial Number: {serial_number}")
print(f"Issuer: {issuer}")
print(f"Subject: {subject}")
print(f"Public Key: {public_key}")
</code></pre>
<h3 id="difference-between-ocsp-and-crl-distribution-points"><a class="header" href="#difference-between-ocsp-and-crl-distribution-points"><strong>Difference between OCSP and CRL Distribution Points</strong></a></h3>
<p><strong>OCSP</strong> (<strong>RFC 2560</strong>) involves a client and a responder working together to check if a digital public-key certificate has been revoked, without needing to download the full <strong>CRL</strong>. This method is more efficient than the traditional <strong>CRL</strong>, which provides a list of revoked certificate serial numbers but requires downloading a potentially large file. CRLs can include up to 512 entries. More details are available <a href="https://www.arubanetworks.com/techdocs/ArubaOS%206_3_1_Web_Help/Content/ArubaFrameStyles/CertRevocation/About_OCSP_and_CRL.htm">here</a>.</p>
<h3 id="what-is-certificate-transparency"><a class="header" href="#what-is-certificate-transparency"><strong>What is Certificate Transparency</strong></a></h3>
<p>Certificate Transparency helps combat certificate-related threats by ensuring the issuance and existence of SSL certificates are visible to domain owners, CAs, and users. Its objectives are:</p>
<ul>
<li>Preventing CAs from issuing SSL certificates for a domain without the domain owner's knowledge.</li>
<li>Establishing an open auditing system for tracking mistakenly or maliciously issued certificates.</li>
<li>Safeguarding users against fraudulent certificates.</li>
</ul>
<h4 id="certificate-logs"><a class="header" href="#certificate-logs"><strong>Certificate Logs</strong></a></h4>
<p>Certificate logs are publicly auditable, append-only records of certificates, maintained by network services. These logs provide cryptographic proofs for auditing purposes. Both issuance authorities and the public can submit certificates to these logs or query them for verification. While the exact number of log servers is not fixed, it's expected to be less than a thousand globally. These servers can be independently managed by CAs, ISPs, or any interested entity.</p>
<h4 id="query"><a class="header" href="#query"><strong>Query</strong></a></h4>
<p>To explore Certificate Transparency logs for any domain, visit <a href="https://crt.sh">https://crt.sh/</a>.</p>
<p>Different formats exist for storing certificates, each with its own use cases and compatibility. This summary covers the main formats and provides guidance on converting between them.</p>
<h2 id="formats"><a class="header" href="#formats"><strong>Formats</strong></a></h2>
<h3 id="pem-format"><a class="header" href="#pem-format"><strong>PEM Format</strong></a></h3>
<ul>
<li>Most widely used format for certificates.</li>
<li>Requires separate files for certificates and private keys, encoded in Base64 ASCII.</li>
<li>Common extensions: .cer, .crt, .pem, .key.</li>
<li>Primarily used by Apache and similar servers.</li>
</ul>
<h3 id="der-format"><a class="header" href="#der-format"><strong>DER Format</strong></a></h3>
<ul>
<li>A binary format of certificates.</li>
<li>Lacks the "BEGIN/END CERTIFICATE" statements found in PEM files.</li>
<li>Common extensions: .cer, .der.</li>
<li>Often used with Java platforms.</li>
</ul>
<h3 id="p7bpkcs7-format"><a class="header" href="#p7bpkcs7-format"><strong>P7B/PKCS#7 Format</strong></a></h3>
<ul>
<li>Stored in Base64 ASCII, with extensions .p7b or .p7c.</li>
<li>Contains only certificates and chain certificates, excluding the private key.</li>
<li>Supported by Microsoft Windows and Java Tomcat.</li>
</ul>
<h3 id="pfxp12pkcs12-format"><a class="header" href="#pfxp12pkcs12-format"><strong>PFX/P12/PKCS#12 Format</strong></a></h3>
<ul>
<li>A binary format that encapsulates server certificates, intermediate certificates, and private keys in one file.</li>
<li>Extensions: .pfx, .p12.</li>
<li>Mainly used on Windows for certificate import and export.</li>
</ul>
<h3 id="converting-formats"><a class="header" href="#converting-formats"><strong>Converting Formats</strong></a></h3>
<p><strong>PEM conversions</strong> are essential for compatibility:</p>
<ul>
<li><strong>x509 to PEM</strong></li>
</ul>
<div class="codeblock_filename_container"><span class="codeblock_filename_inner hljs">bash</span></div>
<pre><code class="language-bash">openssl x509 -in certificatename.cer -outform PEM -out certificatename.pem
</code></pre>
<ul>
<li><strong>PEM to DER</strong></li>
</ul>
<div class="codeblock_filename_container"><span class="codeblock_filename_inner hljs">bash</span></div>
<pre><code class="language-bash">openssl x509 -outform der -in certificatename.pem -out certificatename.der
</code></pre>
<ul>
<li><strong>DER to PEM</strong></li>
</ul>
<div class="codeblock_filename_container"><span class="codeblock_filename_inner hljs">bash</span></div>
<pre><code class="language-bash">openssl x509 -inform der -in certificatename.der -out certificatename.pem
</code></pre>
<ul>
<li><strong>PEM to P7B</strong></li>
</ul>
<div class="codeblock_filename_container"><span class="codeblock_filename_inner hljs">bash</span></div>
<pre><code class="language-bash">openssl crl2pkcs7 -nocrl -certfile certificatename.pem -out certificatename.p7b -certfile CACert.cer
</code></pre>
<ul>
<li><strong>PKCS7 to PEM</strong></li>
</ul>
<div class="codeblock_filename_container"><span class="codeblock_filename_inner hljs">bash</span></div>
<pre><code class="language-bash">openssl pkcs7 -print_certs -in certificatename.p7b -out certificatename.pem
</code></pre>
<p><strong>PFX conversions</strong> are crucial for managing certificates on Windows:</p>
<ul>
<li><strong>PFX to PEM</strong></li>
</ul>
<div class="codeblock_filename_container"><span class="codeblock_filename_inner hljs">bash</span></div>
<pre><code class="language-bash">openssl pkcs12 -in certificatename.pfx -out certificatename.pem
</code></pre>
<ul>
<li><strong>PFX to PKCS#8</strong> involves two steps:
<ol>
<li>Convert PFX to PEM</li>
</ol>
</li>
</ul>
<div class="codeblock_filename_container"><span class="codeblock_filename_inner hljs">bash</span></div>
<pre><code class="language-bash">openssl pkcs12 -in certificatename.pfx -nocerts -nodes -out certificatename.pem
</code></pre>
<ol start="2">
<li>Convert PEM to PKCS8</li>
</ol>
<div class="codeblock_filename_container"><span class="codeblock_filename_inner hljs">bash</span></div>
<pre><code class="language-bash">openSSL pkcs8 -in certificatename.pem -topk8 -nocrypt -out certificatename.pk8
</code></pre>
<ul>
<li><strong>P7B to PFX</strong> also requires two commands:
<ol>
<li>Convert P7B to CER</li>
</ol>
</li>
</ul>
<div class="codeblock_filename_container"><span class="codeblock_filename_inner hljs">bash</span></div>
<pre><code class="language-bash">openssl pkcs7 -print_certs -in certificatename.p7b -out certificatename.cer
</code></pre>
<ol start="2">
<li>Convert CER and Private Key to PFX</li>
</ol>
<div class="codeblock_filename_container"><span class="codeblock_filename_inner hljs">bash</span></div>
<pre><code class="language-bash">openssl pkcs12 -export -in certificatename.cer -inkey privateKey.key -out certificatename.pfx -certfile cacert.cer
</code></pre>
<ul>
<li><strong>ASN.1 (DER/PEM) editing</strong> (works with certificates or almost any other ASN.1 structure):
<ol>
<li>Clone <a href="https://github.com/wllm-rbnt/asn1template/">asn1template</a></li>
</ol>
</li>
</ul>
<div class="codeblock_filename_container"><span class="codeblock_filename_inner hljs">bash</span></div>
<pre><code class="language-bash">git clone https://github.com/wllm-rbnt/asn1template.git
</code></pre>
<ol start="2">
<li>Convert DER/PEM to OpenSSL's generation format</li>
</ol>
<div class="codeblock_filename_container"><span class="codeblock_filename_inner hljs">bash</span></div>
<pre><code class="language-bash">asn1template/asn1template.pl certificatename.der &gt; certificatename.tpl
asn1template/asn1template.pl -p certificatename.pem &gt; certificatename.tpl
</code></pre>
<ol start="3">
<li>Edit certificatename.tpl according to your requirements</li>
</ol>
<div class="codeblock_filename_container"><span class="codeblock_filename_inner hljs">bash</span></div>
<pre><code class="language-bash">vim certificatename.tpl
</code></pre>
<ol start="4">
<li>Rebuild the modified certificate</li>
</ol>
<div class="codeblock_filename_container"><span class="codeblock_filename_inner hljs">bash</span></div>
<pre><code class="language-bash">openssl asn1parse -genconf certificatename.tpl -out certificatename_new.der
openssl asn1parse -genconf certificatename.tpl -outform PEM -out certificatename_new.pem
</code></pre>
<hr />
<div class="mdbook-alerts mdbook-alerts-tip">
<p class="mdbook-alerts-title">
  <span class="mdbook-alerts-icon"></span>
  tip
</p>
<p>Learn &amp; practice AWS Hacking:<img src="../../../../../images/arte.png" alt="" style="width:auto;height:24px;vertical-align:middle;"><a href="https://training.hacktricks.xyz/courses/arte"><strong>HackTricks Training AWS Red Team Expert (ARTE)</strong></a><img src="../../../../../images/arte.png" alt="" style="width:auto;height:24px;vertical-align:middle;"><br />
Learn &amp; practice GCP Hacking: <img src="../../../../../images/grte.png" alt="" style="width:auto;height:24px;vertical-align:middle;"><a href="https://training.hacktricks.xyz/courses/grte"><strong>HackTricks Training GCP Red Team Expert (GRTE)</strong></a><img src="../../../../../images/grte.png" alt="" style="width:auto;height:24px;vertical-align:middle;"></p>
<details>
<summary>Support HackTricks</summary>
<ul>
<li>Check the <a href="https://github.com/sponsors/carlospolop"><strong>subscription plans</strong></a>!</li>
<li><strong>Join the</strong> üí¨ <a href="https://discord.gg/hRep4RUj7f"><strong>Discord group</strong></a> or the <a href="https://t.me/peass"><strong>telegram group</strong></a> or <strong>follow</strong> us on <strong>Twitter</strong> üê¶ <a href="https://twitter.com/hacktricks_live"><strong>@hacktricks_live</strong></a><strong>.</strong></li>
<li><strong>Share hacking tricks by submitting PRs to the</strong> <a href="https://github.com/carlospolop/hacktricks"><strong>HackTricks</strong></a> and <a href="https://github.com/carlospolop/hacktricks-cloud"><strong>HackTricks Cloud</strong></a> github repos.</li>
</ul>
</details>
</div>

                        </main>

                        <nav class="nav-wrapper" aria-label="Page navigation">
                            <!-- Mobile navigation buttons -->
                                <a rel="prev" href="../crypto-and-stego/cryptographic-algorithms/unpacking-binaries.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                    <i class="fa fa-angle-left"></i>
                                </a>

                                <a rel="next prefetch" href="../crypto-and-stego/cipher-block-chaining-cbc-mac-priv.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                    <i class="fa fa-angle-right"></i>
                                </a>

                            <div style="clear: both"></div>
                        </nav>

                        <nav class="nav-wide-wrapper" aria-label="Page navigation">
                                <a rel="prev" href="../crypto-and-stego/cryptographic-algorithms/unpacking-binaries.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                    <i class="fa fa-angle-left"></i><span style="font-size: medium; align-self: center; margin-left: 10px;">Unpacking binaries</span>
                                </a>

                                <a rel="next prefetch" href="../crypto-and-stego/cipher-block-chaining-cbc-mac-priv.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                    <span style="font-size: medium; align-self: center; margin-right: 10px;">Cipher Block Chaining CBC-MAC</span><i class="fa fa-angle-right"></i>
                                </a>
                        </nav>
                    </div>

                    <div class="sidetoc">
                        <div class="sidetoc-wrapper">
                            <nav class="pagetoc"></nav>
                            <a class="sidesponsor" href="" target="_blank">
                                <img src="" alt="" srcset="">
                                <div class="sponsor-title">
                                </div>
                                <div class="sponsor-description">
                                </div>
                                <div class="sponsor-cta"></div>
                            </a>
                        </div>
                    </div>
                </div>
                <div class="footer">
                    <div id="theme-wrapper" class="theme-wrapper">
                        <div id="theme-btns" class="theme-btns">
                            <button id="hacktricks-light" type="button" role="radio" aria-label="Switch to light theme" aria-checked="false" class="theme">
                                <i class="fa fa-sun-o"></i>
                            </button>
                            <button id="hacktricks-dark" type="button" role="radio" aria-label="Switch to dark theme" aria-checked="false" class="theme theme-selected">
                                <i class="fa fa-moon-o"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </div>



        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <!--<script src="../searcher.js"></script>-->

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->
        <script src="../theme/pagetoc.js"></script>
        <script src="../theme/tabs.js"></script>
        <script src="../theme/ht_searcher.js"></script>
        <script src="../theme/sponsor.js"></script>

        <!-- Custom analytics -->
        <script defer src="https://www.fairanalytics.de/pixel/deXeO7BNBrMuhdG1"></script>



    </div>
    </body>
</html>
